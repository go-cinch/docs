# Gorm Genæ•°æ®åº“æ˜ å°„

é¡¹ç›®å†…ç½®gorm/gen, æ•°æ®åº“æ˜ å°„åˆ°struct, é€šè¿‡å·¥å…·è‡ªåŠ¨ç”Ÿæˆ.

## ä¿®æ”¹é…ç½®

### dsn

æ•°æ®åº“è¿æ¥åœ°å€.

### tables

éœ€è¦ç”Ÿæˆçš„è¡¨é›†åˆ.

### exclude

ä¸éœ€è¦ç”Ÿæˆçš„è¡¨é›†åˆ.

### association

å…³è”å…³ç³».

ä¸€èˆ¬æ˜¯5ä¸ªå­—æ®µ, é€šè¿‡`|`åˆ†éš”, `å½“å‰è¡¨å`|`å…³è”è¡¨å`|`ç»“æ„ä½“åç§°`|`å…³ç³»(has_one/has_many/belongs_to/many_to_many)`|`å¤–é”®`

!> belongs_toä¸å¸¸ç”¨, å…·ä½“ç”¨æ³•å‚è€ƒgorm/genå®˜æ–¹æ–‡æ¡£

#### ä¸€å¯¹ä¸€

ç¤ºä¾‹, `ä¸€ä¸ªç”¨æˆ·ä¸€ä¸ªè§’è‰²`:

```yml
gen:
  association:
  - 'user|role|Role|has_one|foreignKey:RoleID'
```

#### ä¸€å¯¹å¤š

ç¤ºä¾‹, `ä¸€ä¸ªé—®é¢˜å¤šä¸ªé€‰é¡¹`:

```yml
gen:
  association:
  - 'question|option|[]Options|has_many|foreignKey:QuestionID'
```

#### å¤šå¯¹å¤š

ç¤ºä¾‹, `ä¸€ä¸ªç”¨æˆ·ç»„å¯èƒ½æœ‰å¤šä¸ªç”¨æˆ·, ä¸€ä¸ªç”¨æˆ·å¯èƒ½å­˜åœ¨å¤šä¸ªç”¨æˆ·ç»„`:

```yml
gen:
  association:
  - 'user_group|user|[]Users|many_to_many|many2many:user_user_group_relation'
  - 'user|user_group|[]UserGroups|many_to_many|many2many:user_user_group_relation'
```

#### ç‰¹åˆ«

å°†å­—æ®µæ˜ å°„ä¸ºæŒ‡é’ˆç±»å‹:

`è¡¨å`|`æŒ‡é’ˆç¬¦å·+å­—æ®µ1,æŒ‡é’ˆç¬¦å·+å­—æ®µ2,...`

```yml
gen:
  association:
  - 'user|*Name,*Role'
```

### field-with-string-tag

å°†å­—æ®µjsonå¢åŠ stringåç¼€:

`è¡¨å`|`å­—æ®µ1,å­—æ®µ2,...`

```yml
gen:
  field-with-string-tag:
  - 'user|id,role_id'
```

ç”Ÿæˆçš„ç»“æ„ä½“, json tagä¼šåƒè¿™æ ·:

```go
type User struct {
	ID     uint64 `json:"id,string"`
	RoleID uint64 `json:"roleId,string"`
}
```

?> è¿™ä¸ªåŠŸèƒ½ä¸»è¦æ˜¯è§£å†³uint64åœ¨å‰ç«¯jsä¼šæº¢å‡º, é€šè¿‡æ˜ å°„ä¸ºstringæ¥ä½œä¸ºå‰ç«¯ç±»å‹

## ç”Ÿæˆæ˜ å°„

```bash
cinch gen gorm
# ğŸº Generate gorm succeeded
# model path internal/data/query
# query path internal/data/model
```

dataç›®å½•ä¸‹ä¼šæ–°å¢ä¸¤ä¸ªç›®å½•, å…¶ä¸­å†…å®¹åŒ…å«modelå’Œquery, åŸºäºgorm/genè‡ªåŠ¨ç”Ÿæˆ

!> ä¸å…è®¸ä¿®æ”¹æˆ–æ–°å¢modelå’Œqueryä¸­çš„ä»»ä½•æ–‡ä»¶, è¢«è¦†ç›–åæœè‡ªè´Ÿ

## æºç 

å‚è§[cinch/gorm](https://github.com/go-cinch/cinch/blob/dev/cmd/cinch/internal/gen/gorm/gorm.go), æœ‰ä»»ä½•é—®é¢˜æˆ–è€…æ–°éœ€æ±‚, æ¬¢è¿æissueæˆ–pr~